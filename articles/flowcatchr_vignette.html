<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`r Biocpkg("flowcatchR")`: A framework for tracking and analyzing flowing  blood cells in time lapse microscopy images
 • flowcatchR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`r Biocpkg(" flowcatchr a framework for tracking and analyzing flowing blood cells in time lapse microscopy images>
<meta property="og:description" content="flowcatchR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flowcatchR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.37.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/flowcatchr_vignette.html">`r Biocpkg("flowcatchR")`: A framework for tracking and analyzing flowing  blood cells in time lapse microscopy images
</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/federicomarini/flowcatchR" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><link href="flowcatchr_vignette_files/htmltools-fill-0.5.8/fill.css" rel="stylesheet">
<script src="flowcatchr_vignette_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="flowcatchr_vignette_files/plotly-binding-4.10.4/plotly.js"></script><script src="flowcatchr_vignette_files/typedarray-0.1/typedarray.min.js"></script><link href="flowcatchr_vignette_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="flowcatchr_vignette_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="flowcatchr_vignette_files/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="flowcatchr_vignette_files/plotly-main-2.11.1/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
<p><em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>:
A framework for tracking and analyzing flowing blood cells in time lapse
microscopy images</p>
                        <h4 data-toc-skip class="author">Federico
Marini</h4>
            <address class="author_afil">
      Institute of Medical Biostatistics, Epidemiology and Informatics
(IMBEI), MainzCenter for Thrombosis and Hemostasis (CTH),
Mainz<br><a class="author_email" href="mailto:#"></a><a href="mailto:marinif@uni-mainz.de" class="email">marinif@uni-mainz.de</a>
      </address>
                              <h4 data-toc-skip class="author">Johanna
Mazur</h4>
            <address class="author_afil">
      Institute of Medical Biostatistics, Epidemiology and Informatics
(IMBEI),
Mainz<br><h4 data-toc-skip class="author">Harald
Binder</h4>
            <address class="author_afil">
      Institute of Medical Biostatistics, Epidemiology and Informatics
(IMBEI), Mainz<br><h4 data-toc-skip class="date">27 March 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/federicomarini/flowcatchR/blob/HEAD/vignettes/flowcatchr_vignette.Rmd" class="external-link"><code>vignettes/flowcatchr_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>flowcatchr_vignette.Rmd</code></div>

    </address>
</address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p><em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
      is a set of tools to analyze in vivo microscopy imaging data,
      focused on tracking flowing blood cells. <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
      guides throughout all the steps of bioimage processing, from
      segmentation to calculation of features, filtering out particles
      not of interest, providing also a set of utilities to help
      checking the quality of the performed operations. The main novel
      contribution investigates the issue of tracking flowing cells such
      as the ones in blood vessels, to categorize the particles in
      flowing, rolling, and adherent by providing a comprehensive
      analysis of the identified trajectories. The extracted information
      is then applied in the study of phenomena such as hemostasis and
      thrombosis development. We expect this package to be potentially
      applied to a variety of assays, covering a wide range of
      applications founded on time-lapse microscopy.</p>
    </div>
    
<p><strong>Compiled date</strong>: 2024-03-27</p>
<p><strong>Last edited</strong>: 2018-01-14</p>
<p><strong>License</strong>: BSD_3_clause + file LICENSE</p>
<div class="section level2">
<h2 id="intro">Introduction<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>This document offers an introduction and overview of the
R/Bioconductor <span class="citation">Gentleman et al. (2004)</span>
package <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>,
which provides a flexible and comprehensive set of tools to detect and
track flowing blood cells in time-lapse microscopy.</p>
<div class="section level3">
<h3 id="why-flowcatchr">Why <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>?<a class="anchor" aria-label="anchor" href="#why-flowcatchr"></a>
</h3>
<p><em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
builds upon functionalities provided by the <em><a href="https://bioconductor.org/packages/3.19/EBImage" class="external-link">EBImage</a></em>
package <span class="citation">(Pau et al. 2010)</span>, and extends
them in order to analyze time-lapse microscopy images. Here we list some
of the unique characteristics of the datasets <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
is designed for:</p>
<ul>
<li>The images come from intravital microscopy experiments. This means
that the Signal-to-Noise Ratio (SNR) is not optimal, and, very
importantly, there are potential major movements of the living specimen
that can be confounded with the true movements of the particles of
interest <span class="citation">(Meijering and Smal 2008)</span>
</li>
<li>Cells are densely distributed on the images, with particles that can
enter and leave the field of view</li>
<li>The acquisition frame rate is a compromise between allowing the
fluorescent cells to be detected and detecting the movements
properly</li>
<li>Cells can flow, temporarily adhere to the endothelial layer and/or
be permanently adherent. Therefore, all movement modalities should be
detected correctly throughout the entire acquisition. Cells can also
cluster together and form (temporary) conglomerates</li>
</ul>
<p>Essential features <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
delivers to the user are:</p>
<ul>
<li>A simple and flexible, yet complete framework to analyze flowing
blood cells (and more generally time-lapse) image sets, with a system of
S4 classes such as <code>Frames</code>, <code>ParticleSet</code>, and
<code>TrajectorySet</code> constituting the backbone of the
procedures</li>
<li>Techniques for aiding the detection of objects in the segmentation
step</li>
<li>An algorithm for tracking the particles, adapted and improved from
the proposal of Sbalzarini and Koumoutsakos (2005) <span class="citation">(Sbalzarini and Koumoutsakos 2005)</span>, that
reflects the directional aspect of the motion</li>
<li>A wide set of functions inspecting the kinematic properties of the
identified trajectories <span class="citation">Meijering, Dzyubachyk,
and Smal (2012)</span>, providing publication-ready summary statistics
and visualization tools to help classifying identified objects</li>
</ul>
<p>This guide includes a brief overview of the entire processing flow,
from importing the raw images to the analysis of kinematic parameters
derived from the identified trajectories. An example dataset will be
used to illustrate the available features, in order to track blood
platelets in consecutive frames derived from an intravital microscopy
acquisition (also available in the package). All steps will be dissected
to explore available parameters and options.</p>
</div>
<div class="section level3">
<h3 id="purpose-of-this-document">Purpose of this document<a class="anchor" aria-label="anchor" href="#purpose-of-this-document"></a>
</h3>
<p>This vignette includes a brief overview of the entire processing
flow, from importing the raw images to the analysis of kinematic
parameters derived from the identified trajectories. An example dataset
will be used to illustrate the available features, in order to track
blood platelets in consecutive frames derived from an intravital
microscopy acquisition (also available in the package). All steps will
be dissected to explore available parameters and options.</p>
</div>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p><em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
is an R package distributed as part of the Bioconductor project. To
install <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>,
please start R and type:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"flowcatchR"</span><span class="op">)</span></span></code></pre></div>
<p>In case you might prefer to install the latest development version,
this can be done with these two lines below:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span> <span class="co"># if needed</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"federicomarini/flowcatchR"</span><span class="op">)</span></span></code></pre></div>
<p>Installation issues should be reported to the Bioconductor support
site (<a href="http://support.bioconductor.org/" class="external-link uri">http://support.bioconductor.org/</a>).</p>
</div>
<div class="section level3">
<h3 id="getting-help">Getting help<a class="anchor" aria-label="anchor" href="#getting-help"></a>
</h3>
<p>The <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
package was tested on a variety of datasets provided from cooperation
partners, yet it may require some extra tuning or bug fixes. For these
issues, please contact the maintainer - if required with a copy of the
error messages, the output of <code>sessionInfo</code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/maintainer.html" class="external-link">maintainer</a></span><span class="op">(</span><span class="st">"flowcatchR"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Federico Marini &lt;marinif@uni-mainz.de&gt;"</span></span></code></pre>
<p>Despite our best efforts to test and develop the package further,
additional functions or interesting suggestions might come from the
specific scenarios that the package users might be facing. Improvements
of existing functions or development of new ones are always most
welcome! We also encourage to fork the GitHub repository of the package
(<a href="https://github.com/federicomarini/flowcatchR" class="external-link uri">https://github.com/federicomarini/flowcatchR</a>), develop
and test the new feature(s), and finally generate a pull request to
integrate it to the original repository.</p>
</div>
<div class="section level3">
<h3 id="citing-flowcatchr">Citing <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em><a class="anchor" aria-label="anchor" href="#citing-flowcatchr"></a>
</h3>
<p>The work underlying the development of <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
has not been formally published yet. A manuscript has been submitted for
peer-review. For the time being, users of <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
are encouraged to cite it using the output of the <code>citation</code>
function, as it follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"flowcatchR"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## To cite the package 'flowcatchR' in publications use:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Federico Marini, Harald Binder (2018). flowcatchR: Tools to analyze</span></span>
<span><span class="co">##   in vivo microscopy imaging data focused on tracking flowing blood</span></span>
<span><span class="co">##   cells. URL http://bioconductor.org/packages/flowcatchR/ doi:</span></span>
<span><span class="co">##   10.18129/B9.bioc.flowcatchR</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   @Manual{,</span></span>
<span><span class="co">##     title = {{flowcatchR}: Tools to analyze in vivo microscopy imaging data focused on</span></span>
<span><span class="co">## tracking flowing blood cells},</span></span>
<span><span class="co">##     author = {Federico Marini and Harald Binder},</span></span>
<span><span class="co">##     year = {2018},</span></span>
<span><span class="co">##     url = {http://bioconductor.org/packages/flowcatchR/},</span></span>
<span><span class="co">##     doi = {10.18129/B9.bioc.flowcatchR},</span></span>
<span><span class="co">##   }</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="overview">Processing overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
works primarily with sets of fluorescent time-lapse images, where the
particles of interest are marked with a fluorescent label (e.g., red for
blood platelets, green for leukocytes). Although different entry spots
are provided (such as the coordinates of identified points in each frame
via tab delimited files), we will illustrate the characteristics of the
package starting from the common protocol starting point. In this case,
we have a set of 20 frames derived from an intravital microscopy
acquisition, which for the sake of practicality were already registered
to reduce the unwanted specimen movements (Fiji <span class="citation">(Schindelin, Arganda-Carreras, and Frise 2012)</span>
was used for this purpose).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/federicomarini/flowcatchR" class="external-link">"flowcatchR"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: EBImage</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"MesenteriumSubset"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># printing summary information for the MesenteriumSubset object</span></span>
<span><span class="va">MesenteriumSubset</span></span></code></pre></div>
<pre><code><span><span class="co">## Frames </span></span>
<span><span class="co">##   colorMode    : Color </span></span>
<span><span class="co">##   storage.mode : double </span></span>
<span><span class="co">##   dim          : 271 131 3 20 </span></span>
<span><span class="co">##   frames.total : 60 </span></span>
<span><span class="co">##   frames.render: 20 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## imageData(object)[1:5,1:6,1,1]</span></span>
<span><span class="co">##           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span></span>
<span><span class="co">## [1,] 0.1647059 0.2117647 0.1882353 0.1803922 0.1607843 0.1333333</span></span>
<span><span class="co">## [2,] 0.2352941 0.1882353 0.1803922 0.1568627 0.1411765 0.1372549</span></span>
<span><span class="co">## [3,] 0.2352941 0.2000000 0.1764706 0.1490196 0.1333333 0.1333333</span></span>
<span><span class="co">## [4,] 0.2352941 0.2117647 0.1764706 0.1529412 0.1411765 0.1411765</span></span>
<span><span class="co">## [5,] 0.2313725 0.2078431 0.1725490 0.1411765 0.1294118 0.1411765</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Channel(s): all</span></span></code></pre>
<p>To obtain the set of trajectories identified from the analysis of the
loaded frames, a very compact one-line command is all that is
needed:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># one command to seize them all :)</span></span>
<span><span class="va">fullResults</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kinematics.html">kinematics</a></span><span class="op">(</span><span class="fu"><a href="../reference/trajectories.html">trajectories</a></span><span class="op">(</span><span class="fu"><a href="../reference/particles.html">particles</a></span><span class="op">(</span><span class="fu"><a href="../reference/channel.Frames.html">channel.Frames</a></span><span class="op">(</span><span class="va">MesenteriumSubset</span>,<span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<!-- microbenchmark(kinematics(trajectories(particles(channel.Frames(MesenteriumSubset,"red"))))) -->
<p>On a MAC OS X machine equipped with 2.8 Ghz Intel Core i7 processor
and 16 GB RAM, the execution of this command takes 2.32 seconds to run
(tests performed with the R package <em><a href="https://CRAN.R-project.org/package=microbenchmark" class="external-link">microbenchmark</a></em>.
On a more recent MacBook Pro (2017), the same benchmark took 1.78
seconds.</p>
<p>The following sections will provide additional details to the
operations mentioned above, with more also on the auxiliary functions
that are available in <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>.</p>
</div>
<div class="section level2">
<h2 id="acquisition">Image acquisition<a class="anchor" aria-label="anchor" href="#acquisition"></a>
</h2>
<p>A set of images is acquired, after a proper microscopy setup has been
performed. This includes for example a careful choice of spatial and
temporal resolution; often a compromise must be met to have a good frame
rate and a good SNR to detect the particles in the single frames. For a
good review on the steps to be taken, please refer to Meijering’s work
<span class="citation">Meijering, Dzyubachyk, and Smal
(2012)</span>.</p>
<p><em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
provides an S4 class that can store the information of a complete
acquisition, namely <code>Frames</code>. The <code>Frames</code> class
extends the <code>Image</code> class, defined in the <em><a href="https://bioconductor.org/packages/3.19/EBImage" class="external-link">EBImage</a></em>
package, and thus exploits the multi-dimensional array structures of the
class. The locations of the images are stored as <code>dimnames</code>
of the <code>Frames</code> object. To construct a <code>Frames</code>
object from a set of images, the <code>read.Frames</code> function is
used:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># initialization</span></span>
<span><span class="va">fullData</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read.Frames.html">read.Frames</a></span><span class="op">(</span>image.files<span class="op">=</span><span class="st">"/path/to/folder/containing/images/"</span>, nframes<span class="op">=</span><span class="fl">100</span><span class="op">)</span> </span>
<span><span class="co"># printing summary information for the Frames object</span></span>
<span><span class="va">fullData</span></span></code></pre></div>
<p><code>nframes</code> specifies the number of frames that will
constitute the <code>Frames</code> object, whereas
<code>image.files</code> is a vector of character strings with the full
location of the (raw) images, or the path to the folder containing them
(works automatically if images are in TIFF/JPG/PNG format). In this case
we just loaded the full dataset, but for the demonstrational purpose of
this vignette, we will proceed with the subset available in the
<code>MesenteriumSubset</code> object, which we previously loaded in
Section @ref(overview).</p>
<p>It is possible to inspect the images composing a <code>Frames</code>
object with the function <code>inspect.Frames</code> (Fig.
@ref(fig:inspectRaw)).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.Frames.html">inspect.Frames</a></span><span class="op">(</span><span class="va">MesenteriumSubset</span>, nframes<span class="op">=</span><span class="fl">9</span>, display.method<span class="op">=</span><span class="st">"raster"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="flowcatchr_vignette_files/figure-html/inspectRaw-1.png" alt="The first 9 frames of the MesenteriumSubset dataset. The red channel stores information about platelets, while the green channel is dedicated to leukocytes" width="720"><p class="caption">
The first 9 frames of the MesenteriumSubset dataset. The red channel
stores information about platelets, while the green channel is dedicated
to leukocytes
</p>
</div>
<p>By default, <code>display.method</code> is set to
<code>browser</code>, as in the <em><a href="https://bioconductor.org/packages/3.19/EBImage" class="external-link">EBImage</a></em>
function display. This opens up a window in the predefined browser
(e.g. Mozilla Firefox), with navigable frames (arrows on the top left
corner). For the vignette, we will set it to <code>raster</code>, for
viewing them as raster graphics using R’s native functions.</p>
<p>Importantly, these image sets were already registered and rotated in
such a way that the overall direction of the movement of interest flows
from left to right, as a visual aid and also to fit with some
assumptions that will be done in the subsequent step of particle
tracking. To register the images, we recommend the general purpose tools
offered by suites such as ImageJ/Fiji <span class="citation">Schindelin,
Arganda-Carreras, and Frise (2012)</span>.</p>
<p>For the following steps, we will focus on the information contained
in the red channel, corresponding in this case to blood platelets. We do
so by calling the <code>channel.Frames</code> function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plateletsMesenterium</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/channel.Frames.html">channel.Frames</a></span><span class="op">(</span><span class="va">MesenteriumSubset</span>, mode<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="va">plateletsMesenterium</span></span></code></pre></div>
<pre><code><span><span class="co">## Frames </span></span>
<span><span class="co">##   colorMode    : Grayscale </span></span>
<span><span class="co">##   storage.mode : double </span></span>
<span><span class="co">##   dim          : 271 131 20 </span></span>
<span><span class="co">##   frames.total : 20 </span></span>
<span><span class="co">##   frames.render: 20 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## imageData(object)[1:5,1:6,1]</span></span>
<span><span class="co">##           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span></span>
<span><span class="co">## [1,] 0.1647059 0.2117647 0.1882353 0.1803922 0.1607843 0.1333333</span></span>
<span><span class="co">## [2,] 0.2352941 0.1882353 0.1803922 0.1568627 0.1411765 0.1372549</span></span>
<span><span class="co">## [3,] 0.2352941 0.2000000 0.1764706 0.1490196 0.1333333 0.1333333</span></span>
<span><span class="co">## [4,] 0.2352941 0.2117647 0.1764706 0.1529412 0.1411765 0.1411765</span></span>
<span><span class="co">## [5,] 0.2313725 0.2078431 0.1725490 0.1411765 0.1294118 0.1411765</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Channel(s): red</span></span></code></pre>
<p>This creates another instance of the class <code>Frames</code>, and
we inspect it in its first 9 frames
(Fig.@ref(fig:inspectPlatelets)).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.Frames.html">inspect.Frames</a></span><span class="op">(</span><span class="va">plateletsMesenterium</span>, nframes<span class="op">=</span><span class="fl">9</span>, display.method<span class="op">=</span><span class="st">"raster"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="flowcatchr_vignette_files/figure-html/inspectPlatelets-1.png" alt="The first 9 frames for the red channel of the MesenteriumSubset dataset. This is just displaying the GrayScale signal for the red channel stored in `plateletsMesenterium` (for the thrombocytes)" width="720"><p class="caption">
The first 9 frames for the red channel of the MesenteriumSubset dataset.
This is just displaying the GrayScale signal for the red channel stored
in <code>plateletsMesenterium</code> (for the thrombocytes)
</p>
</div>
</div>
<div class="section level2">
<h2 id="prepro">Image preprocessing and analysis<a class="anchor" aria-label="anchor" href="#prepro"></a>
</h2>
<p>Steps such as denoising, smoothing and morphological operations
(erosion/dilation, opening/closing) can be performed thanks to the
general functions provided by <em><a href="https://bioconductor.org/packages/3.19/EBImage" class="external-link">EBImage</a></em>.
<em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
offers a wrapper around a series of operations to be applied to all
images in a <code>Frames</code> object. The function
<code>preprocess.Frames</code> is called via the following command:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preprocessedPlatelets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/preprocess.Frames.html">preprocess.Frames</a></span><span class="op">(</span><span class="va">plateletsMesenterium</span>,</span>
<span>                                    brush.size<span class="op">=</span><span class="fl">3</span>, brush.shape<span class="op">=</span><span class="st">"disc"</span>,</span>
<span>                                    at.offset<span class="op">=</span><span class="fl">0.15</span>, at.wwidth<span class="op">=</span><span class="fl">10</span>, at.wheight<span class="op">=</span><span class="fl">10</span>,</span>
<span>                                    kern.size<span class="op">=</span><span class="fl">3</span>, kern.shape<span class="op">=</span><span class="st">"disc"</span>,</span>
<span>                                    ws.tolerance<span class="op">=</span><span class="fl">1</span>, ws.radius<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">preprocessedPlatelets</span></span></code></pre></div>
<pre><code><span><span class="co">## Frames </span></span>
<span><span class="co">##   colorMode    : Grayscale </span></span>
<span><span class="co">##   storage.mode : integer </span></span>
<span><span class="co">##   dim          : 271 131 20 </span></span>
<span><span class="co">##   frames.total : 20 </span></span>
<span><span class="co">##   frames.render: 20 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## imageData(object)[1:5,1:6,1]</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span><span class="co">## [1,]    0    0    0    0    0    0</span></span>
<span><span class="co">## [2,]    0    0    0    0    0    0</span></span>
<span><span class="co">## [3,]    0    0    0    0    0    0</span></span>
<span><span class="co">## [4,]    0    0    0    0    0    0</span></span>
<span><span class="co">## [5,]    0    0    0    0    0    0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Channel(s): red</span></span></code></pre>
<p>The result of this is displayed in Fig.@ref(fig:inspectSegm). For a
detailed explanation of the parameters to better tweak the performances
of this segmentation step, please refer to the help of
<code>preprocess.Frames</code>. To obtain an immediate feedback about
the effects of the operations performed in the full preprocessing phase,
we can call again <code>inspect.Frames</code> on the <code>Frames</code>
of segmented images (Fig.@ref(fig:inspectSegm).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.Frames.html">inspect.Frames</a></span><span class="op">(</span><span class="va">preprocessedPlatelets</span>, nframes<span class="op">=</span><span class="fl">9</span>, display.method<span class="op">=</span><span class="st">"raster"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="flowcatchr_vignette_files/figure-html/inspectSegm-1.png" alt="The first 9 frames after preprocessing of the MesenteriumSubset dataset. The binarized image shows the detected objects after thresholding." width="720"><p class="caption">
The first 9 frames after preprocessing of the MesenteriumSubset dataset.
The binarized image shows the detected objects after thresholding.
</p>
</div>
<p>The frames could be cropped, if e.g. it is needed to remove
background noise that might be present close to the edges. This is done
with the function <code>crop.Frames</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">croppedFrames</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crop.Frames.html">crop.Frames</a></span><span class="op">(</span><span class="va">plateletsMesenterium</span>,</span>
<span>                     cutLeft<span class="op">=</span><span class="fl">6</span>, cutRight<span class="op">=</span><span class="fl">6</span>,</span>
<span>                     cutUp<span class="op">=</span><span class="fl">3</span>, cutDown<span class="op">=</span><span class="fl">3</span>,</span>
<span>                     testing<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">croppedFrames</span></span></code></pre></div>
<pre><code><span><span class="co">## Frames </span></span>
<span><span class="co">##   colorMode    : Grayscale </span></span>
<span><span class="co">##   storage.mode : double </span></span>
<span><span class="co">##   dim          : 260 126 20 </span></span>
<span><span class="co">##   frames.total : 20 </span></span>
<span><span class="co">##   frames.render: 20 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## imageData(object)[1:5,1:6,1]</span></span>
<span><span class="co">##           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span></span>
<span><span class="co">## [1,] 0.1803922 0.1568627 0.1372549 0.1372549 0.1333333 0.1176471</span></span>
<span><span class="co">## [2,] 0.2039216 0.1843137 0.1490196 0.1254902 0.1215686 0.1215686</span></span>
<span><span class="co">## [3,] 0.1843137 0.1764706 0.1568627 0.1294118 0.1176471 0.1019608</span></span>
<span><span class="co">## [4,] 0.1921569 0.1568627 0.1529412 0.1333333 0.1254902 0.1333333</span></span>
<span><span class="co">## [5,] 0.2000000 0.1647059 0.1490196 0.1450980 0.1333333 0.1411765</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Channel(s): red</span></span></code></pre>
<p>If <code>testing</code> is set to true, the function just displays
the first cropped frame, to get a feeling whether the choice of
parameters was adequate. Similarly, for the function
<code>rotate.Frames</code> the same behaviour is expected, whereas the
rotation in degrees is specified by the parameter
<code>angle</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rotatedFrames</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rotate.Frames.html">rotate.Frames</a></span><span class="op">(</span><span class="va">plateletsMesenterium</span>, angle<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">rotatedFrames</span></span></code></pre></div>
<pre><code><span><span class="co">## Frames </span></span>
<span><span class="co">##   colorMode    : Grayscale </span></span>
<span><span class="co">##   storage.mode : double </span></span>
<span><span class="co">##   dim          : 300 249 20 </span></span>
<span><span class="co">##   frames.total : 20 </span></span>
<span><span class="co">##   frames.render: 20 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## imageData(object)[1:5,1:6,1]</span></span>
<span><span class="co">##      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span><span class="co">## [1,]    0    0    0    0    0    0</span></span>
<span><span class="co">## [2,]    0    0    0    0    0    0</span></span>
<span><span class="co">## [3,]    0    0    0    0    0    0</span></span>
<span><span class="co">## [4,]    0    0    0    0    0    0</span></span>
<span><span class="co">## [5,]    0    0    0    0    0    0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Channel(s): red</span></span></code></pre>
<p>If desired, it is possible to select just a subset of the frames
belonging to a <code>Frames</code>. This can be done via the
<code>select.Frames</code> function:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">subsetFrames</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select.Frames.html">select.Frames</a></span><span class="op">(</span><span class="va">plateletsMesenterium</span>,</span>
<span>                       framesToKeep<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">14</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">subsetFrames</span></span></code></pre></div>
<pre><code><span><span class="co">## Frames </span></span>
<span><span class="co">##   colorMode    : Grayscale </span></span>
<span><span class="co">##   storage.mode : double </span></span>
<span><span class="co">##   dim          : 271 131 17 </span></span>
<span><span class="co">##   frames.total : 17 </span></span>
<span><span class="co">##   frames.render: 17 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## imageData(object)[1:5,1:6,1]</span></span>
<span><span class="co">##           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span></span>
<span><span class="co">## [1,] 0.1647059 0.2117647 0.1882353 0.1803922 0.1607843 0.1333333</span></span>
<span><span class="co">## [2,] 0.2352941 0.1882353 0.1803922 0.1568627 0.1411765 0.1372549</span></span>
<span><span class="co">## [3,] 0.2352941 0.2000000 0.1764706 0.1490196 0.1333333 0.1333333</span></span>
<span><span class="co">## [4,] 0.2352941 0.2117647 0.1764706 0.1529412 0.1411765 0.1411765</span></span>
<span><span class="co">## [5,] 0.2313725 0.2078431 0.1725490 0.1411765 0.1294118 0.1411765</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Channel(s): red</span></span></code></pre>
<p>If required, the user can decide to perform a normalization step (via
<code>normalizeFrames</code>), to correct for systematic variations in
the acquisition conditions, in case the overall intensity levels change,
e.g., when the acquisition spans long time scales. In this case, the
median of the intensity sums is chosen as a scaling factor.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normFrames</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalizeFrames.html">normalizeFrames</a></span><span class="op">(</span><span class="va">plateletsMesenterium</span>,normFun <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span></span></code></pre></div>
<p>The user can choose any combination of the operations in order to
segment the images provided as input, but <code>preprocess.Frames</code>
is a very convenient high level function for proceeding in the workflow.
It is also possible, as it was shown in the introductory one-liner, to
call just <code>particles</code> on the raw <code>Frames</code> object.
In this latter case, <code>particles</code> computes the preprocessed
<code>Frames</code> object according to default parameters. Still, in
either situation, the output for this step is an object of the
<code>ParticleSet</code> class.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">platelets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/particles.html">particles</a></span><span class="op">(</span><span class="va">plateletsMesenterium</span>, <span class="va">preprocessedPlatelets</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Computing features in parallel...</span></span>
<span><span class="co">## Done!</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">platelets</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of the ParticleSet class. </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Set of particles for 20 images</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Displaying a subset of the features of the 13 particles found in the first image...</span></span>
<span><span class="co">##   cell.0.m.cx cell.0.m.cy cell.0.m.majoraxis cell.0.m.eccentricity</span></span>
<span><span class="co">## 1   186.70833   47.937500           8.916405             0.6353715</span></span>
<span><span class="co">## 2   256.19048   35.857143           7.746554             0.4606665</span></span>
<span><span class="co">## 3   251.09524   63.523810           8.552466             0.6843186</span></span>
<span><span class="co">## 4   215.54688   51.828125          13.694783             0.8788344</span></span>
<span><span class="co">## 5    15.82759    8.517241           7.548790             0.7570114</span></span>
<span><span class="co">##   cell.0.m.theta cell.0.s.area cell.0.s.perimeter cell.0.s.radius.mean</span></span>
<span><span class="co">## 1      0.3380463            48                 20             3.487042</span></span>
<span><span class="co">## 2      0.9165252            42                 19             3.194559</span></span>
<span><span class="co">## 3      0.9370618            42                 19             3.247531</span></span>
<span><span class="co">## 4      0.7172299            64                 28             4.308530</span></span>
<span><span class="co">## 5      1.5439842            29                 16             2.622403</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Particles identified on the red channel</span></span></code></pre>
<p>The function <code>particles</code> leverages on the multi-core
architecture of the systems where the analysis is run, and this is
implemented via <em><a href="https://bioconductor.org/packages/3.19/BiocParallel" class="external-link">BiocParallel</a></em>
(updated since Version 1.0.3).</p>
<p>As it can be seen from the summary information, each
<code>ParticleSet</code> stores the essential information on all
particles that were detected in the original images, alongside with a
complete set of features, which are computed by integrating the
information from both the raw and the segmented frames.</p>
<p>A <code>ParticleSet</code> can be seen as a named list, where each
element is a <code>data.frame</code> for a single frame, and the image
source is stored as <code>names</code> to help backtracking the
operations performed, and the slot <code>channel</code> is retained as
selected in the initial steps.</p>
<p>It is possible to filter out particles according to their properties,
such as area, shape and eccentricity. This is possible with the function
<code>select.particles</code>. The current implementation regards only
the surface extension, but any additional feature can be chosen and
adopted to restrict the number of candidate particles according to
particular properties which are expected and/or to remove potential
noise that went through the preprocessing phase.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">selectedPlatelets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select.particles.html">select.particles</a></span><span class="op">(</span><span class="va">platelets</span>, min.area<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Filtering the particles...</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">selectedPlatelets</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of the ParticleSet class. </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Set of particles for 20 images</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Displaying a subset of the features of the 13 particles found in the first image...</span></span>
<span><span class="co">##   cell.0.m.cx cell.0.m.cy cell.0.m.majoraxis cell.0.m.eccentricity</span></span>
<span><span class="co">## 1   186.70833   47.937500           8.916405             0.6353715</span></span>
<span><span class="co">## 2   256.19048   35.857143           7.746554             0.4606665</span></span>
<span><span class="co">## 3   251.09524   63.523810           8.552466             0.6843186</span></span>
<span><span class="co">## 4   215.54688   51.828125          13.694783             0.8788344</span></span>
<span><span class="co">## 5    15.82759    8.517241           7.548790             0.7570114</span></span>
<span><span class="co">##   cell.0.m.theta cell.0.s.area cell.0.s.perimeter cell.0.s.radius.mean</span></span>
<span><span class="co">## 1      0.3380463            48                 20             3.487042</span></span>
<span><span class="co">## 2      0.9165252            42                 19             3.194559</span></span>
<span><span class="co">## 3      0.9370618            42                 19             3.247531</span></span>
<span><span class="co">## 4      0.7172299            64                 28             4.308530</span></span>
<span><span class="co">## 5      1.5439842            29                 16             2.622403</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Particles identified on the red channel</span></span></code></pre>
<p>This step can be done iteratively, with the help of the function
<code>add.contours</code>. If called with the parameter
<code>mode</code> set to <code>particles</code>, then it will
automatically generate a <code>Frames</code> object, with the contours
of all particles drawn around the objects that passed the segmentation
(and filtering) step (Fig.@ref(fig:checkSelection)).</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paintedPlatelets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add.contours.html">add.contours</a></span><span class="op">(</span>raw.frames<span class="op">=</span><span class="va">MesenteriumSubset</span>,</span>
<span>                                 binary.frames<span class="op">=</span><span class="va">preprocessedPlatelets</span>,</span>
<span>                                 mode<span class="op">=</span><span class="st">"particles"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/inspect.Frames.html">inspect.Frames</a></span><span class="op">(</span><span class="va">paintedPlatelets</span>, nframes<span class="op">=</span><span class="fl">9</span>, display.method<span class="op">=</span><span class="st">"raster"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="flowcatchr_vignette_files/figure-html/checkSelection-1.png" alt="Particles detected in the first 9 frames. Particles detected in the first 9 frames are shown in yellow, with their contours defined by the segmentation procedure." width="720"><p class="caption">
Particles detected in the first 9 frames. Particles detected in the
first 9 frames are shown in yellow, with their contours defined by the
segmentation procedure.
</p>
</div>
<p>To connect the particles from one frame to the other, we perform
first the detection of particles on all images. Only in a successive
phase, we establish the links between the so identified objects. This
topic will be covered in detail in the following section.</p>
</div>
<div class="section level2">
<h2 id="tracking">Particle tracking<a class="anchor" aria-label="anchor" href="#tracking"></a>
</h2>
<p>To establish the connections between particles, the function to be
called is <code>link.particles</code>. The algorithm used to perform the
tracking itself is an improved version of the original implementation of
Sbalzarini and Koumotsakos <span class="citation">(Sbalzarini and
Koumoutsakos 2005)</span>. To summarize the method, it is a fast and
efficient self-initializing feature point tracking algorithm (using the
centroids of the objects as reference) <span class="citation">(Chenouard
et al. 2014)</span>. The initial version is based on a particle matching
algorithm, approached via a graph theory technique. It allows for
appearances/disappearances of particles from the field of view, also
temporarily as it happens in case of occlusions and objects leaving the
plane of focus.</p>
<p>Our implementation adds to the existing one by redefining the cost
function used in the optimization phase of the link assignment. It
namely adds two terms, such as intensity variation and area variation,
and mostly important implements a function to penalize the movements
that are either perpendicular or backwards with respect to the oriented
flow of cells. Small unwanted movements, which may be present even after
the registration phase, are handled with two jitter terms in a defined
penalty function. Multiplicative factors can further influence the
penalties given to each term.</p>
<p>In its default value, the penalty function is created via the
<code>penaltyFunctionGenerator</code>. The user can exploit the
parameter values in it to create a custom version of it, to match the
particular needs stemming from the nature of the available data and
phenomenon under inspection.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">defaultPenalty</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/penaltyFunctionGenerator.html">penaltyFunctionGenerator</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">defaultPenalty</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## function (angle, distance) </span></span>
<span><span class="co">## {</span></span>
<span><span class="co">##     lambda1 * (distance/(1 - lambda2 * (abs(angle)/(pi + epsilon1))))</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## &lt;bytecode: 0x7fbea49cb630&gt;</span></span>
<span><span class="co">## &lt;environment: 0x7fbea49cbe80&gt;</span></span></code></pre>
<p>As mentioned above, to perform the linking of the particles, we use
<code>link.particles</code>. Fundamental parameters are <code>L</code>
and <code>R</code>, named as in the original implementation.
<code>L</code> is the maximum displacement in pixels that a particle is
expected to have in two consecutive frames, and <code>R</code> is the
value for the link range, i.e. the number of future frames to be
considered for the linking (typically assumes values between 1 - when no
occlusions are known to happen - and 3). An extended explanation of the
parameters is in the documentation of the package.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linkedPlatelets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/link.particles.html">link.particles</a></span><span class="op">(</span><span class="va">platelets</span>,  </span>
<span>                                  L<span class="op">=</span><span class="fl">26</span>, R<span class="op">=</span><span class="fl">3</span>,</span>
<span>                                  epsilon1<span class="op">=</span><span class="fl">0</span>, epsilon2<span class="op">=</span><span class="fl">0</span>,</span>
<span>                                  lambda1<span class="op">=</span><span class="fl">1</span>, lambda2<span class="op">=</span><span class="fl">0</span>,</span>
<span>                                  penaltyFunction<span class="op">=</span><span class="fu"><a href="../reference/penaltyFunctionGenerator.html">penaltyFunctionGenerator</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                  include.area<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">linkedPlatelets</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of the LinkedParticleSet class. </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Set of particles for 20 images</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Particles are tracked throughout the subsequent 3 frame(s)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Displaying a subset of the features of the 13 particles found in the first image...</span></span>
<span><span class="co">##   cell.0.m.cx cell.0.m.cy cell.0.m.majoraxis cell.0.m.eccentricity</span></span>
<span><span class="co">## 1   186.70833   47.937500           8.916405             0.6353715</span></span>
<span><span class="co">## 2   256.19048   35.857143           7.746554             0.4606665</span></span>
<span><span class="co">## 3   251.09524   63.523810           8.552466             0.6843186</span></span>
<span><span class="co">## 4   215.54688   51.828125          13.694783             0.8788344</span></span>
<span><span class="co">## 5    15.82759    8.517241           7.548790             0.7570114</span></span>
<span><span class="co">##   cell.0.m.theta cell.0.s.area cell.0.s.perimeter cell.0.s.radius.mean</span></span>
<span><span class="co">## 1      0.3380463            48                 20             3.487042</span></span>
<span><span class="co">## 2      0.9165252            42                 19             3.194559</span></span>
<span><span class="co">## 3      0.9370618            42                 19             3.247531</span></span>
<span><span class="co">## 4      0.7172299            64                 28             4.308530</span></span>
<span><span class="co">## 5      1.5439842            29                 16             2.622403</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Particles identified on the red channel</span></span></code></pre>
<p>As it can be seen, <code>linkedPlatelets</code> is an object of the
<code>LinkedParticleSet</code> class, which is a subclass of the
<code>ParticleSet</code> class.</p>
<p>After inspecting the trajectories (see Section @ref(trajanal)) it
might be possible to filter a <code>LinkedParticleSet</code> class
object and subsequently reperform the linking on its updated version
(e.g. some detected particles were found to be noise, and thus removed
with <code>select.particles</code>).</p>
<p><em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
provides functions to export and import the identified particles, in
order to offer an additional entry point for tracking and analyzing the
trajectories (if particles were detected with other routines) and also
to store separately the information per each frame about the objects
that were primarily identified.</p>
<p>An example is provided in the lines below, with the functions
<code>export.particles</code> and <code>read.particles</code> :</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># export to csv format</span></span>
<span><span class="fu"><a href="../reference/export.particles.html">export.particles</a></span><span class="op">(</span><span class="va">platelets</span>, dir<span class="op">=</span><span class="st">"/path/to/export/folder/exportParticleSet/"</span><span class="op">)</span></span>
<span><span class="co"># re-import the previously exported, in this case</span></span>
<span><span class="va">importedPlatelets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read.particles.html">read.particles</a></span><span class="op">(</span>particle.files<span class="op">=</span><span class="st">"/path/to/export/folder/exportParticleSet/"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="trajanal">Trajectory analysis<a class="anchor" aria-label="anchor" href="#trajanal"></a>
</h2>
<p>It is possible to extract the trajectories with the correspondent
<code>trajectories</code> function:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trajPlatelets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trajectories.html">trajectories</a></span><span class="op">(</span><span class="va">linkedPlatelets</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Generating trajectories...</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trajPlatelets</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of the TrajectorySet class. </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## TrajectorySet composed of 20 trajectories</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trajectories cover a range of 20 frames</span></span>
<span><span class="co">## Displaying a segment of the first trajectory...</span></span>
<span><span class="co">##        xCoord   yCoord trajLabel frame frameobjectID</span></span>
<span><span class="co">## 1_1  186.7083 47.93750         1     1             1</span></span>
<span><span class="co">## 1_2  186.9649 48.26316         1     2             4</span></span>
<span><span class="co">## 1_3  186.8136 48.18644         1     3             2</span></span>
<span><span class="co">## 1_4  186.2807 47.70175         1     4             1</span></span>
<span><span class="co">## 1_5  186.6897 47.87931         1     5             2</span></span>
<span><span class="co">## 1_6  186.8269 48.11538         1     6             2</span></span>
<span><span class="co">## 1_7  186.9643 48.30357         1     7             1</span></span>
<span><span class="co">## 1_8  186.6207 48.36207         1     8             3</span></span>
<span><span class="co">## 1_9  186.3273 48.05455         1     9             3</span></span>
<span><span class="co">## 1_10 186.9821 48.19643         1    10             3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trajectories are related to particles identified on the red channel</span></span></code></pre>
<p>A <code>TrajectorySet</code> object is returned in this case. It
consists of a two level list for each trajectory, reporting the
<code>trajectory</code> as a <code>data.frame</code>, the number of
points <code>npoints</code> (often coinciding with the number of
<code>nframes</code>, when no gaps <code>ngaps</code> are present) and
its <code>ID</code>. A <code>keep</code> flag is used for subsequent
user evaluation purposes.</p>
<p>Before proceeding with the actual analysis of the trajectories, it is
recommended to evaluate them by visual inspection. <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
provides two complementary methods to do this, either plotting them
(<code>plot</code> or <code>plot2D.TrajectorySet</code>) or drawing the
contours of the points on the original image
(<code>add.contours</code>).</p>
<p>By plotting all trajectories in a 2D+time representation, it’s
possible to have an overview of all trajectories.</p>
<p>The following command gives an interactive 3D (2D+time) view of all
trajectories (Fig.@ref(fig:cubeTrajs)):</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">trajPlatelets</span>, <span class="va">MesenteriumSubset</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"visdat":{"1155f6e21d332":["function () ","plotlyVisDat"]},"cur_data":"1155f6e21d332","attrs":{"1155f6e21d332":{"x":{},"y":{},"z":{},"mode":"lines","line":{"width":2},"split":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"range":[0,0,271]},"yaxis":{"range":[0,0,131]},"scene":{"xaxis":{"title":"xCoord"},"yaxis":{"title":"yCoord"},"zaxis":{"title":"frame"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[186.70833333333334,186.96491228070175,186.81355932203391,186.28070175438597,186.68965517241378,186.82692307692307,186.96428571428572,186.62068965517241,186.32727272727271,186.98214285714286,186.80392156862746,187.05555555555554,187.03571428571428,186.87037037037038,186.94444444444446,187.12962962962962,187.01886792452831,187.17543859649123,186.96153846153845,186.94444444444446],"y":[47.9375,48.263157894736842,48.186440677966104,47.701754385964911,47.879310344827587,48.115384615384613,48.303571428571431,48.362068965517238,48.054545454545455,48.196428571428569,48.176470588235297,48.222222222222221,48.446428571428569,48.388888888888886,48.370370370370374,48.611111111111114,48.679245283018865,48.596491228070178,48.615384615384613,48.370370370370374],"z":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(31,119,180,1)","width":2},"type":"scatter3d","name":"1","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[256.1904761904762,256.42857142857144,256.34693877551018,255.5,256.28846153846155,256.25,256.25,255.91836734693877,255.56862745098039,256.06521739130437,256.14583333333331,256.5,256.64583333333331,256.06382978723406,256.17777777777781,256.63043478260869,256.64583333333331,256.5,256.17777777777781,256.13043478260869],"y":[35.857142857142854,35.673469387755105,35.734693877551024,35.5,35.807692307692307,36.104166666666664,36.104166666666664,35.857142857142854,35.784313725490193,35.956521739130437,36.291666666666664,36.439999999999998,36.458333333333336,36.212765957446805,36.333333333333336,36.217391304347828,36.458333333333336,36.439999999999998,36.333333333333336,36.260869565217391],"z":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(255,127,14,1)","width":2},"type":"scatter3d","name":"2","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[251.0952380952381,251.38297872340425,251.63265306122449,250.57446808510639,251.36170212765958,251.69565217391303,251.06818181818181,250.92857142857142,250.11363636363637,250.92857142857142,250.1044776119403,251.14634146341464,250.14285714285714,250.90697674418604,251,251.16666666666666,251.58139534883722,251.66666666666666,251.02325581395348,251.02380952380952],"y":[63.523809523809526,63.297872340425535,63.367346938775512,63.48936170212766,63.446808510638299,63.695652173913047,63.545454545454547,63.928571428571431,63.840909090909093,63.928571428571431,61.611940298507463,64.048780487804876,61.542857142857144,64.279069767441854,64,64.142857142857139,64,64.288888888888891,64.186046511627907,64.095238095238102],"z":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(44,160,44,1)","width":2},"type":"scatter3d","name":"3","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[215.546875,215.71951219512195,215.72093023255815,215.12048192771084,215.69411764705882,215.69512195121951,215.5625,215.16666666666666,214.83908045977012,215.80722891566265,215.76543209876544,215.79518072289156,215.94805194805195,215.72368421052633,215.61538461538461,215.85897435897436,215.875,215.90123456790124,215.61176470588236,215.48809523809524],"y":[51.828125,52.207317073170735,52.290697674418603,52.012048192771083,52.247058823529414,52.536585365853661,52.612499999999997,52.422222222222224,52.241379310344826,52.614457831325304,52.888888888888886,53.012048192771083,52.79220779220779,52.89473684210526,52.743589743589745,52.974358974358971,53.100000000000001,53.160493827160494,53.035294117647062,52.773809523809526],"z":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(214,39,40,1)","width":2},"type":"scatter3d","name":"4","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null},{"x":[15.827586206896552,15.741935483870968,15.666666666666666,15.4,15.705882352941176,15.939393939393939,16.344827586206897,15.90625,15.387096774193548,16.34375,16.558823529411764,16.558823529411764,16.800000000000001,16.241379310344829,16.633333333333333,16.800000000000001,16.689655172413794,16.774193548387096,16.392857142857142,16.620689655172413],"y":[8.5172413793103452,8.5483870967741939,8.5,8.5,8.5,8.4848484848484844,8.4137931034482758,8.71875,8.3548387096774199,8.5,8.6470588235294112,8.6470588235294112,8.4000000000000004,8.8275862068965516,8.5666666666666664,8.5666666666666664,8.862068965517242,8.9032258064516121,8.5357142857142865,8.3448275862068968],"z":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(148,103,189,1)","width":2},"type":"scatter3d","name":"5","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"frame":null},{"x":[98.560000000000002,98.379310344827587,98.172413793103445,97.935483870967744,98.13333333333334,98.285714285714292,98.379310344827587,98,97.65384615384616,98.379310344827587,98.517241379310349,98.5,98.518518518518519,98.142857142857139,98.548387096774192,98.5,98.5,98.5,98.5,98.34375],"y":[34.799999999999997,34.96551724137931,34.896551724137929,34.677419354838712,34.799999999999997,34.892857142857146,34.96551724137931,35,34.884615384615387,34.96551724137931,35.103448275862071,35.5,35.407407407407405,35.25,35.29032258064516,35.5,35.5,35.5,35.5,35.15625],"z":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(140,86,75,1)","width":2},"type":"scatter3d","name":"6","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"frame":null},{"x":[39.38095238095238,39.620689655172413,39.125,38.782608695652172,39.5,39.399999999999999,39.5,39.090909090909093,38.909090909090907,39.5,39.391304347826086,39.666666666666664,39.08064516129032,39.090909090909093,39.600000000000001,39.5,39.600000000000001,39.600000000000001,39.399999999999999,39.407407407407405],"y":[44.238095238095241,44.482758620689658,44.166666666666664,44.086956521739133,44.166666666666664,44.560000000000002,44.272727272727273,44.909090909090907,44.090909090909093,44.5,44.782608695652172,44.875,47.87096774193548,44.909090909090907,44.960000000000001,45,44.960000000000001,44.960000000000001,44.960000000000001,44.74074074074074],"z":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(227,119,194,1)","width":2},"type":"scatter3d","name":"7","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"frame":null},{"x":[16.897435897435898,35,41.942857142857143,47.484848484848484,61.6875,82.568181818181813,99.641025641025635,110.375,119.63157894736842,127.4054054054054,137.57142857142858,144.25641025641025,152.83333333333334,157.47499999999999,159.71794871794873,163.56410256410257,165.02564102564102,169.94594594594594,175,178.71794871794873],"y":[70.820512820512818,69.820512820512818,68.971428571428575,69.787878787878782,71.125,71.272727272727266,68.102564102564102,69.724999999999994,72.736842105263165,74.945945945945951,73.88095238095238,73.564102564102569,72.714285714285708,74.150000000000006,75.692307692307693,77.564102564102569,80.15384615384616,79.567567567567565,79.5,81.07692307692308],"z":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(127,127,127,1)","width":2},"type":"scatter3d","name":"8","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"frame":null},{"x":[82.333333333333329,82.222222222222229,82.15789473684211,82.05263157894737,82.666666666666671,82.5,82.615384615384613,82.5,82,83.142857142857139,82.666666666666671,83.5,83.666666666666671,83.142857142857139,83,84,84,82.666666666666671],"y":[126.73333333333333,127.05555555555556,127.15789473684211,126.78947368421052,126.73333333333333,126.71428571428571,126.61538461538461,127,126.66666666666667,126.71428571428571,126.33333333333333,127,126.33333333333333,126.71428571428571,126.5,127,127,126.33333333333333],"z":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19],"mode":"lines","line":{"color":"rgba(188,189,34,1)","width":2},"type":"scatter3d","name":"9","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"frame":null},{"x":[113,113,112.53333333333333,112.53333333333333,112.86666666666666,113,113,112.77777777777777,112.59999999999999,113,113.27777777777777,113.35294117647059,113.36363636363636,113,113.46666666666667,113.33333333333333,113.40000000000001,113.33333333333333,113.125,113.23529411764706],"y":[20,20,19.866666666666667,19.866666666666667,20.466666666666665,20.5,20.5,20.5,20.399999999999999,20.5,20.888888888888889,21,21.09090909090909,20.800000000000001,21.133333333333333,21.266666666666666,21.399999999999999,21.333333333333332,21.3125,21],"z":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(23,190,207,1)","width":2},"type":"scatter3d","name":"10","marker":{"color":"rgba(23,190,207,1)","line":{"color":"rgba(23,190,207,1)"}},"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"frame":null},{"x":[186.53846153846155,186.5,186.47368421052633,186.04545454545453,186.5,186.57142857142858,186.71428571428572,186.42857142857142,186.0952380952381,186.65000000000001,186.57142857142858,186.73684210526315,186.89473684210526,186.5,186.81818181818181,186.9047619047619,186.86363636363637,187,186.68181818181819,186.57894736842104],"y":[13.846153846153847,14.8125,14.631578947368421,14.454545454545455,14.777777777777779,15.19047619047619,15.428571428571429,15.380952380952381,15.095238095238095,15.300000000000001,15.619047619047619,15.526315789473685,16.05263157894737,15.5,15.727272727272727,15.952380952380953,16.09090909090909,16.136363636363637,16.136363636363637,15.894736842105264],"z":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(31,119,180,1)","width":2},"type":"scatter3d","name":"11","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[46.399999999999999,69,86.733333333333334,95.58620689655173,107.71428571428571,123,138.6875,154.80555555555554,166,173.96969696969697,183.06451612903226,197.6764705882353,211.63636363636363,213.5,216.18518518518519,222.96296296296296,228.41379310344828,228.59999999999999,229.05405405405406,230.13513513513513],"y":[57.200000000000003,56.393939393939391,58.466666666666669,60.275862068965516,56.821428571428569,54.862068965517238,58.28125,57.75,58.264705882352942,61.575757575757578,62.41935483870968,61.911764705882355,62.68181818181818,64.615384615384613,65.481481481481481,66.592592592592595,67.137931034482762,67.48571428571428,68.567567567567565,69.702702702702709],"z":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(255,127,14,1)","width":2},"type":"scatter3d","name":"12","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[20.5,20.666666666666668,20.125,19.90909090909091,20.545454545454547,20.615384615384617,21.125,13.76595744680851,24.684931506849313,41.407407407407405,64.021739130434781,78.804347826086953,89.869565217391298,98.642857142857139,103.32608695652173,115.61702127659575,131.73170731707316,145.75,166.6829268292683,181.5],"y":[112.5,112.11111111111111,112,112.81818181818181,112.36363636363636,112.38461538461539,111.875,110.48936170212765,113.53424657534246,114.38888888888889,113.41304347826087,113.67391304347827,111.08695652173913,109.9047619047619,110.58695652173913,113,113.26829268292683,109.83928571428571,110.04878048780488,108],"z":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(44,160,44,1)","width":2},"type":"scatter3d","name":"13","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"frame":null},{"x":[248,247.5,248.11111111111111,248,247.85714285714286,247.5,247.77777777777777,247.90000000000001,248.04347826086956,247.52631578947367,248.17391304347825,247.8095238095238,247.90909090909091,247.69999999999999,247.45454545454547,247.36842105263159],"y":[55,56,55.666666666666664,56.5,56.928571428571431,56.5,57.166666666666664,56.899999999999999,56.956521739130437,56.368421052631582,56.913043478260867,56.857142857142854,56.909090909090907,56.899999999999999,56.590909090909093,56.736842105263158],"z":[3,4,5,6,7,8,9,10,12,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(214,39,40,1)","width":2},"type":"scatter3d","name":"14","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"frame":null},{"x":[1.5,16.699999999999999,36.547619047619051,49,55.586206896551722,63.064516129032256,78.65517241379311,94.200000000000003,107.03571428571429,119.33333333333333,129.92857142857142,146.51351351351352,163.30555555555554,178.97142857142856,204.04651162790697,219.14285714285714],"y":[31.5,33.759999999999998,33.023809523809526,29.5,27.275862068965516,26.93548387096774,27.931034482758619,27.600000000000001,29,30,30.30952380952381,31.351351351351351,32.055555555555557,30.885714285714286,32.372093023255815,33],"z":[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(148,103,189,1)","width":2},"type":"scatter3d","name":"15","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"frame":null},{"x":[19,19.666666666666668,20.333333333333332,21.5,19.636363636363637,20.800000000000001,20.333333333333332,20.199999999999999,19.545454545454547],"y":[112.28571428571429,112.33333333333333,112.5,113,113.09090909090909,112.59999999999999,113,112.40000000000001,112.27272727272727],"z":[10,11,12,13,14,16,17,19,20],"mode":"lines","line":{"color":"rgba(140,86,75,1)","width":2},"type":"scatter3d","name":"16","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"frame":null},{"x":[6.4146341463414638,23.820512820512821],"y":[46.536585365853661,48.92307692307692],"z":[11,12],"mode":"lines","line":{"color":"rgba(227,119,194,1)","width":2},"type":"scatter3d","name":"17","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"frame":null},{"x":[27,27,27],"y":[9.5,10,10],"z":[12,14,16],"mode":"lines","line":{"color":"rgba(127,127,127,1)","width":2},"type":"scatter3d","name":"18","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"frame":null},{"x":[51.571428571428569,59.756097560975611,74.228571428571428,87.047619047619051,110.90909090909091,135.82926829268294,151.66666666666666],"y":[47.857142857142854,47.878048780487802,49.028571428571432,53.095238095238095,53.363636363636367,54.31707317073171,54.282051282051285],"z":[14,15,16,17,18,19,20],"mode":"lines","line":{"color":"rgba(188,189,34,1)","width":2},"type":"scatter3d","name":"19","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"frame":null},{"x":[142,142],"y":[11,11],"z":[16,17],"mode":"lines","line":{"color":"rgba(23,190,207,1)","width":2},"type":"scatter3d","name":"20","marker":{"color":"rgba(23,190,207,1)","line":{"color":"rgba(23,190,207,1)"}},"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p class="caption">
A 2D+time representation of the trajectories. This is produced by
plotting a <code>TrajectoryList</code> object
</p>
</div>
<p>The <code>plot2D.TrajectorySet</code> focuses on additional
information and a different “point of view”, but can just display a two
dimensional projection of the identified trajectories
(Fig.@ref(fig:overviewTrajs)).</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot2D.TrajectorySet.html">plot2D.TrajectorySet</a></span><span class="op">(</span><span class="va">trajPlatelets</span>, <span class="va">MesenteriumSubset</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="flowcatchr_vignette_files/figure-html/overviewTrajs-1.png" alt='A 2D "flat" representation of the trajectories. This is more suitable to give an indication of the global movement' width="720"><p class="caption">
A 2D “flat” representation of the trajectories. This is more suitable to
give an indication of the global movement
</p>
</div>
<p>To have more insights on single trajectories, or on a subset of them,
<code>add.contours</code> offers an additional mode called
<code>trajectories</code>. Particles are drawn on the raw images with
colours corresponding to the trajectory IDs. <code>add.contours</code>
plots by default all trajectories, but the user can supply a vector of
the IDs of interest to override this behaviour.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paintedTrajectories</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add.contours.html">add.contours</a></span><span class="op">(</span>raw.frames<span class="op">=</span><span class="va">MesenteriumSubset</span>,</span>
<span>                                    binary.frames<span class="op">=</span><span class="va">preprocessedPlatelets</span>,  </span>
<span>                                    trajectoryset<span class="op">=</span><span class="va">trajPlatelets</span>,</span>
<span>                                    mode<span class="op">=</span><span class="st">"trajectories"</span><span class="op">)</span></span>
<span><span class="va">paintedTrajectories</span></span></code></pre></div>
<pre><code><span><span class="co">## Frames </span></span>
<span><span class="co">##   colorMode    : Color </span></span>
<span><span class="co">##   storage.mode : double </span></span>
<span><span class="co">##   dim          : 271 131 3 20 </span></span>
<span><span class="co">##   frames.total : 60 </span></span>
<span><span class="co">##   frames.render: 20 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## imageData(object)[1:5,1:6,1,1]</span></span>
<span><span class="co">##           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span></span>
<span><span class="co">## [1,] 0.1647059 0.2117647 0.1882353 0.1803922 0.1607843 0.1333333</span></span>
<span><span class="co">## [2,] 0.2352941 0.1882353 0.1803922 0.1568627 0.1411765 0.1372549</span></span>
<span><span class="co">## [3,] 0.2352941 0.2000000 0.1764706 0.1490196 0.1333333 0.1333333</span></span>
<span><span class="co">## [4,] 0.2352941 0.2117647 0.1764706 0.1529412 0.1411765 0.1411765</span></span>
<span><span class="co">## [5,] 0.2313725 0.2078431 0.1725490 0.1411765 0.1294118 0.1411765</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Channel(s): all</span></span></code></pre>
<p>As with any other <code>Frames</code> object, it is recommended to
take a peek at it via the <code>inspect.Frames</code> function
(Fig.@ref(fig:inspectTrajs)):</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.Frames.html">inspect.Frames</a></span><span class="op">(</span><span class="va">paintedTrajectories</span>,nframes<span class="op">=</span><span class="fl">9</span>,display.method<span class="op">=</span><span class="st">"raster"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="flowcatchr_vignette_files/figure-html/inspectTrajs-1.png" alt="Particles detected in the first 9 frames. These are shown this time in colours corresponding to the identified trajectories, again with their contours defined by the segmentation procedure." width="720"><p class="caption">
Particles detected in the first 9 frames. These are shown this time in
colours corresponding to the identified trajectories, again with their
contours defined by the segmentation procedure.
</p>
</div>
<p>To allow for a thorough evaluation of the single trajectories,
<code>export.Frames</code> is a valid helper, as it creates single
images corresponding to each frame in the <code>Frames</code> object. We
first extract for example trajectory 11 (Fig.@ref(fig:traj11)) with the
following command:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">traj11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add.contours.html">add.contours</a></span><span class="op">(</span>raw.frames<span class="op">=</span><span class="va">MesenteriumSubset</span>,</span>
<span>                       binary.frames<span class="op">=</span><span class="va">preprocessedPlatelets</span>,</span>
<span>                       trajectoryset<span class="op">=</span><span class="va">trajPlatelets</span>,</span>
<span>                       mode<span class="op">=</span><span class="st">"trajectories"</span>,</span>
<span>                       trajIDs<span class="op">=</span><span class="fl">11</span><span class="op">)</span></span>
<span><span class="va">traj11</span></span></code></pre></div>
<pre><code><span><span class="co">## Frames </span></span>
<span><span class="co">##   colorMode    : Color </span></span>
<span><span class="co">##   storage.mode : double </span></span>
<span><span class="co">##   dim          : 271 131 3 20 </span></span>
<span><span class="co">##   frames.total : 60 </span></span>
<span><span class="co">##   frames.render: 20 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## imageData(object)[1:5,1:6,1,1]</span></span>
<span><span class="co">##           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]</span></span>
<span><span class="co">## [1,] 0.1647059 0.2117647 0.1882353 0.1803922 0.1607843 0.1333333</span></span>
<span><span class="co">## [2,] 0.2352941 0.1882353 0.1803922 0.1568627 0.1411765 0.1372549</span></span>
<span><span class="co">## [3,] 0.2352941 0.2000000 0.1764706 0.1490196 0.1333333 0.1333333</span></span>
<span><span class="co">## [4,] 0.2352941 0.2117647 0.1764706 0.1529412 0.1411765 0.1411765</span></span>
<span><span class="co">## [5,] 0.2313725 0.2078431 0.1725490 0.1411765 0.1294118 0.1411765</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Channel(s): all</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/inspect.Frames.html">inspect.Frames</a></span><span class="op">(</span><span class="va">traj11</span>, nframes<span class="op">=</span><span class="fl">9</span>, display.method<span class="op">=</span><span class="st">"raster"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="flowcatchr_vignette_files/figure-html/traj11-1.png" alt="First 9 frames for trajectory with ID 11. This is supplied to the `trajIds` argument of `add.contours`" width="720"><p class="caption">
First 9 frames for trajectory with ID 11. This is supplied to the
<code>trajIds</code> argument of <code>add.contours</code>
</p>
</div>
<p>The data for trajectory 11 in the <code>TrajectorySet</code> object
can be printed to the terminal:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trajPlatelets</span><span class="op">[[</span><span class="fl">11</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## $trajectory</span></span>
<span><span class="co">##         xCoord   yCoord trajLabel frame frameobjectID</span></span>
<span><span class="co">## 11_1  186.5385 13.84615        11     1            11</span></span>
<span><span class="co">## 11_2  186.5000 14.81250        11     2            12</span></span>
<span><span class="co">## 11_3  186.4737 14.63158        11     3            11</span></span>
<span><span class="co">## 11_4  186.0455 14.45455        11     4             9</span></span>
<span><span class="co">## 11_5  186.5000 14.77778        11     5            11</span></span>
<span><span class="co">## 11_6  186.5714 15.19048        11     6            12</span></span>
<span><span class="co">## 11_7  186.7143 15.42857        11     7            11</span></span>
<span><span class="co">## 11_8  186.4286 15.38095        11     8            12</span></span>
<span><span class="co">## 11_9  186.0952 15.09524        11     9            11</span></span>
<span><span class="co">## 11_10 186.6500 15.30000        11    10            13</span></span>
<span><span class="co">## 11_11 186.5714 15.61905        11    11            14</span></span>
<span><span class="co">## 11_12 186.7368 15.52632        11    12            12</span></span>
<span><span class="co">## 11_13 186.8947 16.05263        11    13            12</span></span>
<span><span class="co">## 11_14 186.5000 15.50000        11    14            15</span></span>
<span><span class="co">## 11_15 186.8182 15.72727        11    15            13</span></span>
<span><span class="co">## 11_16 186.9048 15.95238        11    16            11</span></span>
<span><span class="co">## 11_17 186.8636 16.09091        11    17            12</span></span>
<span><span class="co">## 11_18 187.0000 16.13636        11    18            11</span></span>
<span><span class="co">## 11_19 186.6818 16.13636        11    19            15</span></span>
<span><span class="co">## 11_20 186.5789 15.89474        11    20            16</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $npoints</span></span>
<span><span class="co">## [1] 20</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nframes</span></span>
<span><span class="co">## [1] 20</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ngaps</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $keep</span></span>
<span><span class="co">## [1] NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ID</span></span>
<span><span class="co">## [1] 11</span></span></code></pre>
<p>After that, it can also be exported with the following command (the
<code>dir</code> parameter must be changed accordingly):</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/export.Frames.html">export.Frames</a></span><span class="op">(</span><span class="va">traj11</span>, dir<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, nameStub<span class="op">=</span><span class="st">"vignetteTest_traj11"</span>,</span>
<span>              createGif<span class="op">=</span><span class="cn">TRUE</span>, removeAfterCreatingGif<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><code>export.Frames</code> offers multiple ways to export - animated
gif (if <code>ImageMagick</code> is available and installed on the
system) or multiple jpeg/png images.</p>
<p>Of course the user might want to singularly evaluate each trajectory
that was identified, and this can be done by looping over the trajectory
IDs.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">evaluatedTrajectories</span> <span class="op">&lt;-</span> <span class="va">trajPlatelets</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">trajPlatelets</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">paintedTraj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add.contours.html">add.contours</a></span><span class="op">(</span>raw.frames<span class="op">=</span><span class="va">MesenteriumSubset</span>,</span>
<span>                              binary.frames<span class="op">=</span><span class="va">preprocessedPlatelets</span>,</span>
<span>                              trajectoryset<span class="op">=</span><span class="va">trajPlatelets</span>,</span>
<span>                              mode<span class="op">=</span><span class="st">"trajectories"</span>,</span>
<span>                              col<span class="op">=</span><span class="st">"yellow"</span>,</span>
<span>                              trajIDs<span class="op">=</span><span class="va">i</span><span class="op">)</span>  </span>
<span>  <span class="fu"><a href="../reference/export.Frames.html">export.Frames</a></span><span class="op">(</span><span class="va">paintedTraj</span>,</span>
<span>                nameStub<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"vignetteTest_evaluation_traj_oneByOne_"</span>,<span class="va">i</span><span class="op">)</span>,</span>
<span>                createGif<span class="op">=</span><span class="cn">TRUE</span>, removeAfterCreatingGif<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="co">### uncomment the code below to perform the interactive evaluation of the single trajectories</span></span>
<span></span>
<span>  <span class="co">#   cat("Should I keep this trajectory? --- 0: NO, 1:YES --- no other values allowed")</span></span>
<span>  <span class="co">#   userInput &lt;- readLines(n=1L)</span></span>
<span>  <span class="co">#   ## if neither 0 nor 1, do not update</span></span>
<span>  <span class="co">#   ## otherwise, this becomes the value for the field keep in the new TrajectoryList</span></span>
<span>  <span class="co">#   evaluatedTrajectories@.Data[[i]]$keep &lt;- as.logical(as.numeric(userInput))</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Always using trajectory 11 as example, we would set
<code>evaluatedTrajectories[[11]]$keep</code> to <code>TRUE</code>,
since the trajectory was correctly identified, as we just checked.</p>
<p>Once all trajectories have been selected, we can proceed to calculate
(a set of) kinematic parameters, for a single or all trajectories in a
<code>TrajectorySet</code> object. The function <code>kinematics</code>
returns the desired output, respectively a
<code>KinematicsFeatures</code> object, a
<code>KinematicsFeaturesSet</code>, a single value or a vector (or list,
if not coercible to vector) of these single values (one parameter for
each trajectory).</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allKinematicFeats.allPlatelets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kinematics.html">kinematics</a></span><span class="op">(</span><span class="va">trajPlatelets</span>,</span>
<span>                                             trajectoryIDs<span class="op">=</span><span class="cn">NULL</span>, <span class="co"># will select all trajectory IDs </span></span>
<span>                                             acquisitionFrequency<span class="op">=</span><span class="fl">30</span>, <span class="co"># value in milliseconds</span></span>
<span>                                             scala<span class="op">=</span><span class="fl">50</span>, <span class="co"># 1 pixel is equivalent to ... micrometer</span></span>
<span>                                             feature<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="co"># all kinematic features available</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in extractKinematics.traj(trajectoryset, i, acquisitionFrequency =</span></span>
<span><span class="co">## acquisitionFrequency, : The trajectory with ID 17 had 3 or less points, no</span></span>
<span><span class="co">## features were computed.</span></span></code></pre>
<pre><code><span><span class="co">## Warning in extractKinematics.traj(trajectoryset, i, acquisitionFrequency =</span></span>
<span><span class="co">## acquisitionFrequency, : The trajectory with ID 18 had 3 or less points, no</span></span>
<span><span class="co">## features were computed.</span></span></code></pre>
<pre><code><span><span class="co">## Warning in extractKinematics.traj(trajectoryset, i, acquisitionFrequency =</span></span>
<span><span class="co">## acquisitionFrequency, : The trajectory with ID 20 had 3 or less points, no</span></span>
<span><span class="co">## features were computed.</span></span></code></pre>
<p>As it is reported from the output, the function raises a warning for
trajectories which have 3 or less points, as they might be spurious
detections. In such cases, no kinematic features are computed.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allKinematicFeats.allPlatelets</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of the KinematicsFeaturesSet class. </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## KinematicsFeaturesSet composed of 20  KinematicsFeatures objects</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Available features (shown for the first trajectory):</span></span>
<span><span class="co">##  [1] "delta.x"                     "delta.t"                    </span></span>
<span><span class="co">##  [3] "delta.v"                     "totalTime"                  </span></span>
<span><span class="co">##  [5] "totalDistance"               "distStartToEnd"             </span></span>
<span><span class="co">##  [7] "curvilinearVelocity"         "straightLineVelocity"       </span></span>
<span><span class="co">##  [9] "linearityForwardProgression" "trajMSD"                    </span></span>
<span><span class="co">## [11] "velocityAutoCorr"            "instAngle"                  </span></span>
<span><span class="co">## [13] "directChange"                "dirAutoCorr"                </span></span>
<span><span class="co">## [15] "paramsNotComputed"          </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Curvilinear Velocity: 0.009970094 </span></span>
<span><span class="co">## Total Distance: 5.682953 </span></span>
<span><span class="co">## Total Time: 570 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Average values (calculated on 3 trajectories where parameters were computed)</span></span>
<span><span class="co">## Average Curvilinear Velocity: 0.1278174 </span></span>
<span><span class="co">## Average Total Distance: 56.08449 </span></span>
<span><span class="co">## Average Total Time: 518.8235</span></span></code></pre>
<p>A summary for the returned object (in this case a
<code>KinematicsFeaturesSet</code>) shows some of the computed
parameters. By default, information about the first trajectory is
reported in brief, and the same parameters are evaluated on average
across the selected trajectories. The true values can be accessed in
this case for each trajectory by the subset operator for lists
(<code>[[]]</code>), followed by the name of the kinematic feature
(e.g., <code>$totalDistance</code>).</p>
<p>A list of all available parameters is printed with an error message
if the user specifies an incorrect name, such as here:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allKinematicFeats.allPlatelets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kinematics.html">kinematics</a></span><span class="op">(</span><span class="va">trajPlatelets</span>, feature<span class="op">=</span><span class="st">"?"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Available features to compute are listed here below.</span></span>
<span><span class="co">##           Please select one among delta.x, delta.t, delta.v, totalTime,</span></span>
<span><span class="co">##           totalDistance, distStartToEnd, curvilinearVelocity,</span></span>
<span><span class="co">##           straightLineVelocity, linearityForwardProgression, trajMSD,</span></span>
<span><span class="co">##           velocityAutoCorr, instAngle, directChange or dirAutoCorr</span></span></code></pre>
<p>When asking for a single parameter, the value returned is structured
in a vector, such that it is straightforward to proceed with further
analysis, e.g. by plotting the distribution of the curvilinear
velocities (Fig.@ref(fig:allVelos)).</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allVelocities</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kinematics.html">kinematics</a></span><span class="op">(</span><span class="va">trajPlatelets</span>, feature<span class="op">=</span><span class="st">"curvilinearVelocity"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">allVelocities</span>, breaks<span class="op">=</span><span class="fl">10</span>, probability<span class="op">=</span><span class="cn">TRUE</span>, col<span class="op">=</span><span class="st">"cadetblue"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Curvilinear Velocities Distribution"</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Trajectory Analysis: Curvilinear Velocities"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">allVelocities</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"steelblue"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="flowcatchr_vignette_files/figure-html/allVelos-1.png" alt="Histogram of the curvilinear velocities for all trajectories identified in the MesenteriumSubset dataset" width="700"><p class="caption">
Histogram of the curvilinear velocities for all trajectories identified
in the MesenteriumSubset dataset
</p>
</div>
<p>For this code chunk, we are suppressing the warning messages, as they
would be exactly the same as in the former where all features were
computed for each trajectory.</p>
</div>
<div class="section level2">
<h2 id="interactive-tools-for-a-user-friendly-workflow-solution">Interactive tools for a user-friendly workflow solution<a class="anchor" aria-label="anchor" href="#interactive-tools-for-a-user-friendly-workflow-solution"></a>
</h2>
<p>To enhance the <code>Frames</code> objects and deliver an immediate
feedback to the user, the function <code>snap</code> leverages on both
the raw and binary <code>Frames</code>, as well as on the corresponding
<code>ParticleSet</code> and <code>TrajectorySet</code> objects. It
integrates the information available in all the mentioned objects, and
it plots a modified instance of the <code>Frames</code> object,
identifying the particles closest to the mouse click, and showing
additional trajectory-related information, such as the trajectory ID and
the instantaneous velocity of the cell. The function can be called as in
the command below:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/snap.html">snap</a></span><span class="op">(</span><span class="va">MesenteriumSubset</span>,<span class="va">preprocessedPlatelets</span>,</span>
<span>     <span class="va">platelets</span>,<span class="va">trajPlatelets</span>,</span>
<span>     frameID <span class="op">=</span> <span class="fl">1</span>,showVelocity <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p>An example output for the <code>snap</code> is shown below in
Fig.@ref(fig:snapExample), where the information (trajectory ID, as well
as the velocity in the selected frame) is shown in yellow to offer a
good contrast with the fluorescent image.</p>
<div class="figure">
<img src="flowcatchr_vignette_files/figure-html/snapExample-1.png" alt="Output generated by the snap function. The user wanted to identify the particle and additionally display the trajectory information (ID, instantaneous velocity) on it." width="672"><p class="caption">
Output generated by the snap function. The user wanted to identify the
particle and additionally display the trajectory information (ID,
instantaneous velocity) on it.
</p>
</div>
<div class="section level3">
<h3 id="the-shinyflow-shiny-application">The <code>shinyFlow</code> Shiny Application<a class="anchor" aria-label="anchor" href="#the-shinyflow-shiny-application"></a>
</h3>
<p>Additionally, since Version 1.0.3, <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
delivers <code>shinyFlow</code>, a Shiny Web Application (<span class="citation">(RStudio, Inc 2013)</span>), which is built on the
backbone of the analysis presented in this vignette, and is portable
across all main operating systems. The user is thus invited to explore
datasets and parameters with immediate reactive feedback, that can
enable better understanding of the effects of single steps and changes
in the workflow.</p>
<p>To launch the Shiny App, use the command below to open an external
window either in the browser or in the IDE (such as RStudio):</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/shinyFlow.html">shinyFlow</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="flowcatchr-in-jupyter-notebooks">
<em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
in Jupyter notebooks<a class="anchor" aria-label="anchor" href="#flowcatchr-in-jupyter-notebooks"></a>
</h3>
<p>A further integration are a number of Jupyter/IPython notebooks
(<span class="citation">(Pérez and Granger 2007)</span>), as a way to
provide easy reproducibility as well as communication of results, by
combining plain text, commands and output in single documents. The R
kernel used on the back-end was developed by Thomas Kluyver (<a href="https://github.com/takluyver/IRkernel" class="external-link uri">https://github.com/takluyver/IRkernel</a>), and instructions
for the installation are available at the Github repository website. The
notebooks are available in the installation folder of the package <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>,
which can be found with the command below.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,package <span class="op">=</span> <span class="st">"flowcatchR"</span><span class="op">)</span>,pattern <span class="op">=</span> <span class="st">"*.ipynb"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "template_DetectionOfTransmigrationEvents.ipynb"</span></span>
<span><span class="co">## [2] "template_flowcatchR_vignetteSummary.ipynb"</span></span></code></pre>
<p>The notebooks are provided as template for further steps in the
analysis. The user is invited to set up the IPython notebook framework
as explained on the official website for the project (<a href="http://ipython.org/notebook.html" class="external-link uri">http://ipython.org/notebook.html</a>). As of February, 3rd
2015, the current way to obtain the Jupyter environment is via the
<code>3.0.dev</code> version, available via Github (<a href="https://github.com/ipython/ipython" class="external-link uri">https://github.com/ipython/ipython</a>). The notebooks can
be opened and edited by navigating to their location while the IPython
notebook server is running; use the following command in the shell to
launch it:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="sc">$</span> ipython notebook</span></code></pre></div>
<p>Alternatively, these documents can be viewed with the
<code>nbviewer</code> tool, available at <a href="http://nbviewer.ipython.org/" class="external-link uri">http://nbviewer.ipython.org/</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="flowcatchr-in-docker-containers">
<em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
in Docker containers<a class="anchor" aria-label="anchor" href="#flowcatchr-in-docker-containers"></a>
</h2>
<p><em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
is now (as of September 2015) available also in Docker images that are
the components of the <code>dockerflow</code> proposal (<a href="https://github.com/federicomarini/dockerflow" class="external-link uri">https://github.com/federicomarini/dockerflow</a>). This
includes:</p>
<ul>
<li>
<code>flowstudio</code> - <a href="https://github.com/federicomarini/flowstudio" class="external-link uri">https://github.com/federicomarini/flowstudio</a>, a
command-line/IDE interface to RStudio where <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
and its dependencies are preinstalled</li>
<li>
<code>flowshiny</code> - <a href="https://github.com/federicomarini/flowshiny" class="external-link uri">https://github.com/federicomarini/flowshiny</a> a Shiny
Server running the <code>shinyFlow</code> web application</li>
<li>
<code>flowjupy</code> - <a href="https://github.com/federicomarini/flowjupy" class="external-link uri">https://github.com/federicomarini/flowjupy</a>, a Jupyter
Notebook interface</li>
</ul>
<p>These three images can be run simultaneously, provided the system
where the containers are running supports the
<code>docker-compose</code> tool. For more information on how to install
the single components, please refer to their repositories.</p>
</div>
<div class="section level2">
<h2 id="supplinfo">Supplementary information<a class="anchor" aria-label="anchor" href="#supplinfo"></a>
</h2>
<p>For more information on the method adapted for tracking cells, see
Sbalzarini and Koumotsakos (2005) <span class="citation">(Sbalzarini and
Koumoutsakos 2005)</span>. For additional details regarding the
functions of <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>,
please consult the documentation or write an email to <a href="mailto:marinif@uni-mainz.de" class="email">marinif@uni-mainz.de</a>.</p>
<p>Due to space limitations, the complete dataset for the acquired
frames used in this vignette is not included as part of the <em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
package. If you would like to get access to it, you can write an email
to <a href="mailto:marinif@uni-mainz.de" class="email">marinif@uni-mainz.de</a>.</p>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>This package was developed at the Institute of Medical Biostatistics,
Epidemiology and Informatics at the University Medical Center, Mainz
(Germany), with the financial support provided by the TRP-A15
Translational Research Project grant.</p>
<p><em><a href="https://bioconductor.org/packages/3.19/flowcatchR" class="external-link">flowcatchR</a></em>
incorporates suggestions and feedback from the wet-lab biology units
operating at the Center for Thrombosis and Hemostasis (CTH), in
particular Sven Jäckel and Kerstin Jurk. Sven Jäckel also provided us
with the sample acquisition which is available in this vignette.</p>
<p>We would like to thank the members of the Biostatistics division for
valuable discussions, and additionally Isabella Zwiener for contributing
to the first ideas on the project.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<p>This vignette was generated using the following package versions:</p>
<pre><code><span><span class="co">## R Under development (unstable) (2024-03-27 r86211)</span></span>
<span><span class="co">## Platform: x86_64-apple-darwin20</span></span>
<span><span class="co">## Running under: macOS Monterey 12.7.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.5-x86_64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] flowcatchR_1.37.0 EBImage_4.45.1    BiocStyle_2.31.0 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] gtable_0.3.4        xfun_0.43           bslib_0.6.2        </span></span>
<span><span class="co">##  [4] ggplot2_3.5.0       htmlwidgets_1.6.4   lattice_0.22-6     </span></span>
<span><span class="co">##  [7] crosstalk_1.2.1     vctrs_0.6.5         tools_4.5.0        </span></span>
<span><span class="co">## [10] bitops_1.0-7        generics_0.1.3      parallel_4.5.0     </span></span>
<span><span class="co">## [13] tibble_3.2.1        fansi_1.0.6         highr_0.10         </span></span>
<span><span class="co">## [16] pkgconfig_2.0.3     data.table_1.15.2   desc_1.4.3         </span></span>
<span><span class="co">## [19] lifecycle_1.0.4     compiler_4.5.0      textshaping_0.3.7  </span></span>
<span><span class="co">## [22] munsell_0.5.0       tiff_0.1-12         codetools_0.2-19   </span></span>
<span><span class="co">## [25] httpuv_1.6.15       htmltools_0.5.8     sass_0.4.9         </span></span>
<span><span class="co">## [28] lazyeval_0.2.2      RCurl_1.98-1.14     yaml_2.3.8         </span></span>
<span><span class="co">## [31] plotly_4.10.4       tidyr_1.3.1         later_1.3.2        </span></span>
<span><span class="co">## [34] pkgdown_2.0.7.9000  pillar_1.9.0        jquerylib_0.1.4    </span></span>
<span><span class="co">## [37] BiocParallel_1.37.1 cachem_1.0.8        abind_1.4-5        </span></span>
<span><span class="co">## [40] mime_0.12           tidyselect_1.2.1    locfit_1.5-9.9     </span></span>
<span><span class="co">## [43] digest_0.6.35       dplyr_1.1.4         purrr_1.0.2        </span></span>
<span><span class="co">## [46] bookdown_0.38       fastmap_1.1.1       grid_4.5.0         </span></span>
<span><span class="co">## [49] colorspace_2.1-0    cli_3.6.2           magrittr_2.0.3     </span></span>
<span><span class="co">## [52] utf8_1.2.4          scales_1.3.0        promises_1.2.1     </span></span>
<span><span class="co">## [55] rmarkdown_2.26      httr_1.4.7          fftwtools_0.9-11   </span></span>
<span><span class="co">## [58] jpeg_0.1-10         ragg_1.3.0          png_0.1-8          </span></span>
<span><span class="co">## [61] memoise_2.0.1       shiny_1.8.1         evaluate_0.23      </span></span>
<span><span class="co">## [64] knitr_1.45          viridisLite_0.4.2   rlang_1.1.3        </span></span>
<span><span class="co">## [67] Rcpp_1.0.12         xtable_1.8-4        glue_1.7.0         </span></span>
<span><span class="co">## [70] BiocManager_1.30.22 BiocGenerics_0.49.1 jsonlite_1.8.8     </span></span>
<span><span class="co">## [73] R6_2.5.1            systemfonts_1.0.6   fs_1.6.3           </span></span>
<span><span class="co">## [76] colorRamps_2.3.4</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Beltman2009" class="csl-entry">
Beltman, JB, AFM Marée, and RJ de Boer. 2009. <span>“<span class="nocase">Analysing immune cell migration</span>.”</span>
<em>Nature Reviews Immunology</em> 9 (11): 789–98. <a href="https://doi.org/10.1038/nri2638" class="external-link">https://doi.org/10.1038/nri2638</a>.
</div>
<div id="ref-Chenouard2014" class="csl-entry">
Chenouard, Nicolas, Ihor Smal, Fabrice de Chaumont, Martin Maška, Ivo F
Sbalzarini, Yuanhao Gong, Janick Cardinale, et al. 2014. <span>“<span class="nocase">Objective comparison of particle tracking
methods.</span>”</span> <em>Nature Methods</em> 11 (3): 281–89. <a href="https://doi.org/10.1038/nmeth.2808" class="external-link">https://doi.org/10.1038/nmeth.2808</a>.
</div>
<div id="ref-Gentleman2004" class="csl-entry">
Gentleman, Robert C, Vincent J. Carey, Douglas M. Bates, et al. 2004.
<span>“<span class="nocase">Bioconductor: Open software development for
computational biology and bioinformatics</span>.”</span> <em>Genome
Biology</em> 5: R80. <a href="http://genomebiology.com/2004/5/10/R80" class="external-link">http://genomebiology.com/2004/5/10/R80</a>.
</div>
<div id="ref-Meijering2012a" class="csl-entry">
Meijering, Erik, Oleh Dzyubachyk, and Ihor Smal. 2012. <span>“<span class="nocase">Methods for cell and particle tracking.</span>”</span>
<em>Methods in Enzymology</em> 504 (February): 183–200. <a href="https://doi.org/10.1016/B978-0-12-391857-4.00009-4" class="external-link">https://doi.org/10.1016/B978-0-12-391857-4.00009-4</a>.
</div>
<div id="ref-Meijering2008" class="csl-entry">
Meijering, Erik, and Ihor Smal. 2008. <span>“<span class="nocase">Time-lapse imaging</span>.”</span> In <em>Microscope
Image Processing</em>, 401–40. <span>Academic Press</span>. <a href="http://www.imagescience.org/meijering/publications/download/tlmi2008.pdf" class="external-link">http://www.imagescience.org/meijering/publications/download/tlmi2008.pdf</a>.
</div>
<div id="ref-Pau2010" class="csl-entry">
Pau, Grégoire, Florian Fuchs, Oleg Sklyar, Michael Boutros, and Wolfgang
Huber. 2010. <span>“<span class="nocase">EBImage–an R package for image
processing with applications to cellular phenotypes.</span>”</span>
<em>Bioinformatics</em> 26 (7): 979–81. <a href="https://doi.org/10.1093/bioinformatics/btq046" class="external-link">https://doi.org/10.1093/bioinformatics/btq046</a>.
</div>
<div id="ref-Perez2007" class="csl-entry">
Pérez, Fernando, and Brian E. Granger. 2007.
<span>“<span>IP</span>ython: A System for Interactive Scientific
Computing.”</span> <em>Computing in Science and Engineering</em> 9 (3):
21–29. <a href="https://doi.org/10.1109/MCSE.2007.53" class="external-link">https://doi.org/10.1109/MCSE.2007.53</a>.
</div>
<div id="ref-Rlang2014" class="csl-entry">
R Core Team. 2014. <em><span class="nocase">R: A Language and
Environment for Statistical Computing</span></em>. Vienna, Austria: R
Foundation for Statistical Computing. <a href="http://www.R-project.org/" class="external-link">http://www.R-project.org/</a>.
</div>
<div id="ref-Shiny2013" class="csl-entry">
RStudio, Inc. 2013. <em>Easy Web Applications in r.</em>
</div>
<div id="ref-Sbalzarini2005" class="csl-entry">
Sbalzarini, I F, and P Koumoutsakos. 2005. <span>“<span class="nocase">Feature point tracking and trajectory analysis for video
imaging in cell biology.</span>”</span> <em>Journal of Structural
Biology</em> 151 (2): 182–95. <a href="https://doi.org/10.1016/j.jsb.2005.06.002" class="external-link">https://doi.org/10.1016/j.jsb.2005.06.002</a>.
</div>
<div id="ref-Schindelin2012" class="csl-entry">
Schindelin, Johannes, I Arganda-Carreras, and Erwin Frise. 2012.
<span>“<span class="nocase">Fiji: an open-source platform for
biological-image analysis</span>.”</span> <em>Nature Methods</em> 9 (7):
676–82. <a href="https://doi.org/10.1038/nmeth.2019" class="external-link">https://doi.org/10.1038/nmeth.2019</a>.
</div>
<div id="ref-Schneider2012" class="csl-entry">
Schneider, Caroline a, Wayne S Rasband, and Kevin W Eliceiri. 2012.
<span>“<span class="nocase">NIH Image to ImageJ: 25 years of image
analysis</span>.”</span> <em>Nature Methods</em> 9 (7): 671–75. <a href="https://doi.org/10.1038/nmeth.2089" class="external-link">https://doi.org/10.1038/nmeth.2089</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://federicomarini.github.io" class="external-link">Federico Marini</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
